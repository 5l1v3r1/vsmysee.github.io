---
layout: article
title: 我眼中的数据结构
---
我们的大学先是被模拟电路和数字电路虐,然后被数据结构和算法分析虐,可是工作多年后反过来思考,其实学问这个东西,要是有一个开悟了的前辈用形象化的教学方式来
让你从趣味中学习,学问就不那么可怕了,如果没有这个老师,那就自己打坐吧。

## 存储和信息
计算机系统一共分为6级存储,分别是L0,L1,L2,L3,L4,L5,依次对应寄存器,CPU L1高速缓存,CPU L2高速缓存,L3主存,L4本地磁盘,L5网络或者分布式文件系统。数据由位组成
位和上下文一起来表示信息,代码和数据本质都是数据。

![](/images/memory_layer.png)


我们表示数据的最小单位是字节,它由八个bit组成,计算机的主存就是由这些字节一个紧挨着一个排列着,每一个字节都有一个地址让CPU随机地在常量时间内定位到数据,那么数据
在计算机中最自然的结构就是一个数组,他们连续,而且被编号,这个编号我们叫做数组的下标,通过这个下标就可以快速的找到数据。

所以,可以得出一个结论,计算机中的数据结构只有一种,那就是数组,其他的所有数据结构都是由数组变形的,只不过另外取了名字,比如链表,树,图。一个bit数长度为1的数组,我们可以
对它进行逻辑运算,一个字节就是由8个bit组成的数组。数据组织成了某种结构之后,我们开始对它进行各种操作,这些操作分为:增,删,改,查。这些操作叫做指令或者算法,于是程序等于数据结构加上算法,对象就是一个数据结构和算法的合体,闭包就是代码在运行时形成对象等
这些概念就非常自然了。

## 一切皆数组
我们有了数组这个结构之后,就可表示一堆数据了,程序中我们可以写成这样:[0,1,2,3,4,5,6,5,4,3,2,1,0],现在要寻找其中一个数,就必须机械的无穷遍历,最坏的情况下,你要找的数据正好
是最后一个,那么你花去的时间和数组的长度成正比,修改一个数也得现在找到,所以代价一样,当然如果你明确知道下标位置,则是常量时间。

![](/images/array.png)

数组最麻烦的两个操作是删除和插入,删除操作分为通过下标删除和通过查找来删除,下标删除可以快速定位到要删除的元素,删除的本质就是将后面的所有元素往前移动
一个位置,数组长度是固定的,经过移动之后将最后一个元素释放掉。而插入操作也同样麻烦,如果是在数组后面追加,得先申请空间,如果是在中间插入,不断要申请空间还需要移动元素。

所以数组唯一的优点是为每个元素赋予了一个编号,通过这个编号能够快速找到它,其他没有利用到这个编号的所有操作都是麻烦的。但是对于按内容来遍历查找数组的时候
有一个特殊情况,那就是数组是有序的,在有序数组中查找我们可以用折半原理,每次可以将搜索范围缩小一半,这样做的本质是将内容搜索的暴力遍历
转化到下标上去。

## 提升维度
如果单个元素我们称为0维,数组就是元素从长度上开始延伸进入到了一维,但是不够彻底,数组把元素限制了在一维上的某段空间,元素和元素之间拥有了编号,但是不灵活,于是我们把元素和元素自由分布
在这个直线维度上,去掉了编号,获得插入和删除灵活性,每个元素自己是一个小数组,数组有三个元素,第一个指向前面那个小数组,第三个指向后面那个小数组,于是这个结构的插入和删除操作
仅仅是将小数组中第一个和第三个元素中的值修改一下即可,这便得到了我们称为链表的数据结构。

![](/images/linked.jpg)


链表和数组是在一维空间上的结构,我们也叫做线性表,用链表和数组我们可以实现计算机科学中两个非常基础又非常重要的抽象结构:栈和队列,这是两个及其有用的结构。另外就是
我们使用最平凡的字符串。
链表丢弃了数组的编号优点取得了删除和插入的快速,链表和数组都有具备遍历上的机械性,数组因为有了下标而在二分查找中有了绝对优势,那么我们能在链表上实现二分吗?


### 链表二分
当数组的元素构造成有序的时候,我们可以通过二分查找快速的定位到元素,但是如果元素是线性链表的时候,即便元素是有序的,因为没有了编号所以没办法
快速定位,怎么办?我们只能让这个链表结构上二分,所以必须把链表提升到平面这个维度,这样我们先构造一个节点,如果元素大于当前节点则连接到左边,如果元素小于这节点则连接
到右边,这样构造完之后看起来就是一个树状结构,它呈现在平面上。这样就综合了数组和链表的有点,查找我们可以二分(要么左要么又),删除和修改快速。

可是问题又来了,你会发现链表就是二叉数的一种特殊情况,加入在构造这个数的时候,元素本身就有序,最后构造出来的仅仅就是一个一维的链表,我已我们遇到了新的一个代价:维护
树结构,数的复杂度在于深度和平衡,链表就是一个严重失去平衡又深度的大的树结构。

![](/images/bsort.jpg)


### 组合数组和链表
数组和链表或者树都各有优点,想象一下我们是否可以发明一种结构把他们组合起来呢?这个结构融合多维度,提供了快速的查找能力,他的基本原理是将元素通过一个hash
算法得到一个数字,这个数字对应数组的下表,然后将元素放进数组下标对应的内存空间中。查找变为完美的常量时间,更新和插入操作也一样的快,这个结构近乎于完美,可是要保存
的元素无限,但是hash出来的数字确可能冲突,况且我们不可能开辟一个很大的数组空间,于是hash出来的数字需要变换到数组的长度内,而且需要解决hash冲突之后元素如何存放的问题
通用做法是再开辟一个链表,假设冲突严重的话,链表就会非常长,这个结构又回归到线性表的局限上了,如果元素是可比较的,我们可以用二叉排序树来代替链表。所以用好这个结构我们们需要
选择好的散列函数。

![](/images/hashmap_working.png)


## 平面这个大舞台
当我们的数据结构演变到了树结构之后,事情就变得复杂起来,我们会发现树可以是一个非常复杂的结构,有二叉树,二叉排序树,红黑数,B树,堆,Trie树等,每一种树都解决了
我们问题空间中的某个问题,但是始终是没有完美的数据结构。

树结构是一个层次结构,我们生活中有太多这样的例子,金字塔,国家结构,公司部门等,就像我们打破数组和链表这个线性结构而得到树一样,我们如果打破树的这个层次
结构会怎么样,我们不需要一个根,全部平等对待,于是各个节点自由连接,就形成了一个在目前我们的眼界内最复杂的一个结构,我们叫做图。

![](/images/graph.png)

图是什么?你打开地图,把每个城市或者每一个国家看着一个点,然后把他们自由连接起来,或者你想象每天地球上的起降的飞机连接的结构,或者社交网络上的关注网。图完全可以理解为一个网。
它在平面上自由延伸,和链表是树的特殊情况一样,树其实是图的特殊情况,而图最终表达了我们这个世界的维度,图再扩展到三维,四维,...十维将会得到更加美妙的形状和数据结构。

当然数据结构研究至此,我们可能需要研究哲学等宇宙终极问题了

![](/images/weidu.jpeg)
