---
layout: article
title: 分布式和集群
---

分布式，其实就是多机计算，其出现的前提应该是单机性能的提高和计算机网络的发明，如果某个系统会被多台机器运算从而达到某种运算目的，这个系统就可以说是一个分布式系统，把这个概念延伸出去，管理多个机器硬件资源的操作系统叫分布式操作系统，管理多个机器上的文件或数据的系统叫分布式文件系统或分布式数据库系统，把数据放到多台机器上缓存然后对它进行管理的软件系统叫分布式缓存系统，我们在电脑上开发的web数据库系统，如果不考虑浏览器到tomcat的协议连接，不考虑jdbc到数据库的协议连接，假想他们完全就是本机的进程调用，那么这就是完全的单机系统，如果你把浏览器计算，tomcat计算，数据库计算放到不同的机器上，然后通过网络连接，这就是个分布式系统了。 

分布式，就是分而治之，人多好办事的思想，利用群体的智慧，目的就是综合多台机器的计算能力来提供高性能和可伸缩性，同时免费获得负载均衡，故障恢复等特性。负载均衡可以让用户端觉得高性能同时在服务端提供可伸缩性，故障恢复对应的特性就应该是高性能和可用性。 

单机计算有其计算理论，多机计算也有相应的计算理论，多机计算理论其中需要重点考虑的一个因素就是网络连接，所以在分布式系统上分析算法复杂度需要引入一个网络变量。 

如果一个系统的架构和实现能够做到随意的增添机器并把它管理起来然后对用户提供高质量服务，那么这个系统就是一个无敌的系统。随意增添机器就是强大的伸缩性，高质量服务包括友好的UI，系统响应快速，和具备适用需求变化的能力。 

那么分布式和集群有什么关系？集群又叫机群或者群集，通俗点就是多机，分布式的本质也是多机，所以我认为没有什么差别，不过人们普遍理解的集群是把多个机器通过计算机网络组合起来给用户虚拟一台超级计算机，让用户觉得像在使用单机一样，每台机器都可能部署相同的服务，然后进行负载均衡和故障恢复，负载均衡和故障恢复站在用户的角度就是一个计算机能够悄悄的提升性能和全年不停机。而分布式的概念就大于集群，包括所谓的网格计算，云就算，其本质就是分布式计算，不过层次更高，更加抽象而已，分布式在概念上还有客户端分布式（比如memcache)，服务端分布式。 


分布式计算，多个机器通过网络连接进行协作计算，其面向程序员的这个层次有几个重要的名词： 

1,CAP原理，一致性，可用性，分布式，如果说去掉分布式，也就是单机，那么你可以做到一致和可用，因为就是一台机器，CPU取数据也就是内存和自身机器上的IO端口，但是如果分布式，一致性和可用性你只能达到其中一个，为什么？你要在多台机器通过网络连接这样的拓扑结构里做到高一致，代价是比较高的，再加上网络连接是非常复杂和容易出异常的，所以必然对用户来说丧失可用性，比如你要把数据同步到10000台机器上，耗时10分钟，完成了再对用户的请求做响应。如果你选择可用性，那么你就必须牺牲一致性，这也是大多数架构师在分布式架构时的选择，通过降低一致性换取可用性，降低一致性不是说不一致而是最终一致，不是让集群里机的器在同一时刻高度一只，而是让时间错位到达最终一致。 

2,分布式编程，首要解决的就是机器通信，按通信方式有如下几种技术分类 

a,二进制，其代表就是Corba和EJB，他们通过专用的二进制协议来实现分布式对象通信，同时提供分布式编程API

b,SOAP,这是一个对象访问协议，通过它构建的webservice也可以做到分布式编程，这个协议可以凌驾在其他协议之上，比如可以走http通道。 

c,REST,这是目前认为大道至简的分布式架构风格，它将业务领域抽象为各种资源对象，然后通过统一的操作接口去操纵资源，目前直接使用http协议。 

当然分布式编程是非常复杂的，不过，通过引入一个间接层来降低复杂度也是可以的，典型算法就是Google的MR，其灵感来源于函数式编程。在对付巨量数据处理的业务场景非常有用，java领域有实现了MR的编程框架hadoop，你只要能够将你的业务场景抽象为两个函数，然后hadoop就可以透明的分布式完成计算目的。
